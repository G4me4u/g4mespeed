package com.g4mesoft.util;

public class GSColorUtil {

	/* REDS */
	public static final int INDIAN_RED             = 0xFFCD5C5C;
	public static final int LIGHT_CORAL            = 0xFFF08080;
	public static final int SALMON                 = 0xFFFA8072;
	public static final int DARK_SALMON            = 0xFFE9967A;
	public static final int LIGHT_SALMON           = 0xFFFFA07A;
	public static final int CRIMSON_SALMON         = 0xFFDC143C;
	public static final int RED                    = 0xFFFF0000;
	public static final int FIRE_BRICK             = 0xFFB22222;
	public static final int DARK_RED               = 0xFF8B0000;

	/* PINKS */
	public static final int PINK                   = 0xFFFFC0CB;
	public static final int LIGHT_PINK             = 0xFFFFB6C1;
	public static final int HOT_PINK               = 0xFFFF69B4;
	public static final int DEEP_PINK              = 0xFFFF1493;
	public static final int MEDIUM_VIOLET_RED      = 0xFFC71585;
	public static final int PALE_VIOLET_RED        = 0xFFDB7093;
	
	/* ORANGES */
	public static final int CORAL                  = 0xFFFF7F50;
	public static final int TOMATO                 = 0xFFFF6347;
	public static final int ORANGE_RED             = 0xFFFF4500;
	public static final int DARK_ORANGE            = 0xFFFF8C00;
	public static final int ORANGE                 = 0xFFFFA500;
	
	/* YELLOWS */
	public static final int GOLD                   = 0xFFFFD700;
	public static final int YELLOW                 = 0xFFFFFF00;
	public static final int LIGHT_YELLOW           = 0xFFFFFFE0;
	public static final int LEMON_CHIFFON          = 0xFFFFFACD;
	public static final int LIGHT_GOLDENROD_YELLOW = 0xFFFAFAD2;
	public static final int PAPAYA_WHIP            = 0xFFFFEFD5;
	public static final int MOCCASIN               = 0xFFFFE4B5;
	public static final int PEACH_PUFF             = 0xFFFFDAB9;
	public static final int PALE_GOLDENROD         = 0xFFEEE8AA;
	public static final int KHAKI                  = 0xFFF0E68C;
	public static final int DARK_KHAKI             = 0xFFBDB76B;
	
	/* PURPLES */
	public static final int LAVENDER               = 0xFFE6E6FA;
	public static final int THISTLE                = 0xFFD8BFD8;
	public static final int PLUM                   = 0xFFDDA0DD;
	public static final int VIOLET                 = 0xFFEE82EE;
	public static final int ORCHID                 = 0xFFDA70D6;
	public static final int FUCHSIA                = 0xFFFF00FF;
	public static final int MAGENTA                = FUCHSIA;
	public static final int MEDIUM_ORCHID          = 0xFFBA55D3;
	public static final int MEDIUM_PURPLE          = 0xFF9370DB;
	public static final int BLUE_VIOLET            = 0xFF8A2BE2;
	public static final int DARK_VIOLET            = 0xFF9400D3;
	public static final int DARK_ORCHID            = 0xFF9932CC;
	public static final int DARK_MAGENTA           = 0xFF8B008B;
	public static final int PURPLE                 = 0xFF800080;
	public static final int REB_PURPLE             = 0xFF663399;
	public static final int INDIGO                 = 0xFF4B0082;
	public static final int MEDIUM_SLATE_BLUE      = 0xFF7B68EE;
	public static final int SLATE_BLUE             = 0xFF6A5ACD;
	public static final int DARK_SLATE_BLUE        = 0xFF483D8B;
	
	/* GREENS */
	public static final int GREEN_YELLOW           = 0xFFADFF2F;
	public static final int CHARTREUSE             = 0xFF7FFF00;
	public static final int LAWN_GREEN             = 0xFF7CFC00;
	public static final int LIME                   = 0xFF00FF00;
	public static final int LIME_GREEN             = 0xFF32CD32;
	public static final int PALE_GREEN             = 0xFF98FB98;
	public static final int LIGHT_GREEN            = 0xFF90EE90;
	public static final int MEDIUM_SPRING_GREEN    = 0xFF00FA9A;
	public static final int SPRING_GREEN           = 0xFF00FF7F;
	public static final int MEDIUM_SEA_GREEN       = 0xFF3CB371;
	public static final int SEA_GREEN              = 0xFF2E8B57;
	public static final int FOREST_GREEN           = 0xFF228B22;
	public static final int GREEN                  = 0xFF008000;
	public static final int DARK_GREEN             = 0xFF006400;
	public static final int YELLOW_GREEN           = 0xFF9ACD32;
	public static final int OLIVE_DRAB             = 0xFF6B8E23;
	public static final int OLIVE                  = 0xFF808000;
	public static final int DARK_OLIVE_GREEN       = 0xFF556B2F;
	public static final int MEDIUM_AQUAMARINE      = 0xFF66CDAA;
	public static final int DARK_SEA_GREEN         = 0xFF8FBC8F;
	public static final int LIGHT_SEA_GREEN        = 0xFF20B2AA;
	public static final int DARK_CYAN              = 0xFF008B8B;
	public static final int TEAL                   = 0xFF008080;
	
	/* BLUES / CYANS */
	public static final int AQUA                   = 0xFF00FFFF;
	public static final int CYAN                   = AQUA;
	public static final int LIGHT_CYAN             = 0xFFE0FFFF;
	public static final int PALE_TURQUOISE         = 0xFFAFEEEE;
	public static final int AQUAMARINE             = 0xFF7FFFD4;
	public static final int TURQUOISE              = 0xFF40E0D0;
	public static final int MEDIUM_TURQUOISE       = 0xFF48D1CC;
	public static final int DARK_TURQUOISE         = 0xFF00CED1;
	public static final int CADET_BLUE             = 0xFF5F9EA0;
	public static final int STEEL_BLUE             = 0xFF4682B4;
	public static final int LIGHT_STEEL_BLUE       = 0xFFB0C4DE;
	public static final int POWDER_BLUE            = 0xFFB0E0E6;
	public static final int LIGHT_BLUE             = 0xFFADD8E6;
	public static final int SKY_BLUE               = 0xFF87CEEB;
	public static final int LIGHT_SKY_BLUE         = 0xFF87CEFA;
	public static final int DEEP_SKY_BLUE          = 0xFF00BFFF;
	public static final int DODGER_BLUE            = 0xFF1E90FF;
	public static final int CORNFLOWER_BLUE        = 0xFF6495ED;
	public static final int ROYAL_BLUE             = 0xFF4169E1;
	public static final int BLUE                   = 0xFF0000FF;
	public static final int MEDIUM_BLUE            = 0xFF0000CD;
	public static final int JENIFER_BLUE           = 0xFF06066D;
	public static final int DARK_BLUE              = 0xFF00008B;
	public static final int NAVY                   = 0xFF000080;
	public static final int MIDNIGHT_BLUE          = 0xFF191970;
	
	/* BROWNS */
	public static final int CORNSILK               = 0xFFFFF8DC;
	public static final int BLANCHED_ALMOND        = 0xFFFFEBCD;
	public static final int BISQUE                 = 0xFFFFE4C4;
	public static final int NAVAJO_WHITE           = 0xFFFFDEAD;
	public static final int WHEAT                  = 0xFFF5DEB3;
	public static final int BURLY_WOOD             = 0xFFDEB887;
	public static final int TAN                    = 0xFFD2B48C;
	public static final int ROSY_BROWN             = 0xFFBC8F8F;
	public static final int SANDY_BROWN            = 0xFFF4A460;
	public static final int GOLDENROD              = 0xFFDAA520;
	public static final int DARK_GOLDENROD         = 0xFFB8860B;
	public static final int PERU                   = 0xFFCD853F;
	public static final int CHOCOLATE              = 0xFFD2691E;
	public static final int SADDLE_BROWN           = 0xFF8B4513;
	public static final int SIENNA                 = 0xFFA0522D;
	public static final int BROWN                  = 0xFFA52A2A;
	public static final int MAROON                 = 0xFF800000;
	
	/* WHITES */
	public static final int WHITE                  = 0xFFFFFFFF;
	public static final int SNOW                   = 0xFFFFFAFA;
	public static final int HONEYDEW               = 0xFFF0FFF0;
	public static final int MINT_CREAM             = 0xFFF5FFFA;
	public static final int AZURE                  = 0xFFF0FFFF;
	public static final int ALICE_BLUE             = 0xFFF0F8FF;
	public static final int GHOST_WHITE            = 0xFFF8F8FF;
	public static final int WHITE_SMOKE            = 0xFFF5F5F5;
	public static final int SEASHELL               = 0xFFFFF5EE;
	public static final int BEIGE                  = 0xFFF5F5DC;
	public static final int OLD_LACE               = 0xFFFDF5E6;
	public static final int FLORAL_WHITE           = 0xFFFFFAF0;
	public static final int IVORY                  = 0xFFFFFFF0;
	public static final int ANTIQUE_WHITE          = 0xFFFAEBD7;
	public static final int LINEN                  = 0xFFFAF0E6;
	public static final int LAVENDER_BLUSH         = 0xFFFFF0F5;
	public static final int MISTY_ROSE             = 0xFFFFE4E1;
	
	/* GREYS */
	public static final int GAINSBORO              = 0xFFDCDCDC;
	public static final int LIGHT_GRAY             = 0xFFD3D3D3;
	public static final int LIGHT_GREY             = LIGHT_GRAY;
	public static final int SILVER                 = 0xFFC0C0C0;
	public static final int DARK_GRAY              = 0xFFA9A9A9;
	public static final int DARK_GREY              = DARK_GRAY;
	public static final int GRAY                   = 0xFF808080;
	public static final int GREY                   = GRAY;
	public static final int DIM_GRAY               = 0xFF696969;
	public static final int DIM_GREY               = DIM_GRAY;
	public static final int LIGHT_SLATE_GRAY       = 0xFF778899;
	public static final int LIGHT_SLATE_GREY       = LIGHT_SLATE_GRAY;
	public static final int SLATE_GRAY             = 0xFF708090;
	public static final int SLATE_GREY             = SLATE_GRAY;
	public static final int DARK_SLATE_GRAY        = 0xFF2F4F4F;
	public static final int DARK_SLATE_GREY        = DARK_SLATE_GRAY;
	public static final int BLACK                  = 0xFF000000;
	
	private static final double SRGB_2_XYZ_B11 = 0.4124;
	private static final double SRGB_2_XYZ_B12 = 0.3576;
	private static final double SRGB_2_XYZ_B13 = 0.1805;

	private static final double SRGB_2_XYZ_B21 = 0.2126;
	private static final double SRGB_2_XYZ_B22 = 0.7152;
	private static final double SRGB_2_XYZ_B23 = 0.0722;

	private static final double SRGB_2_XYZ_B31 = 0.0193;
	private static final double SRGB_2_XYZ_B32 = 0.1192;
	private static final double SRGB_2_XYZ_B33 = 0.9505;
	
	private static final double D65_XN =  95.0489;
	private static final double D65_YN = 100.0000;
	private static final double D65_ZN = 108.8840;
	
	private static final double LAB_DELTA = 6.0 / 29.0;
	private static final double LAB_DELTA_SQ = LAB_DELTA * LAB_DELTA;
	private static final double LAB_DELTA_CB = LAB_DELTA_SQ * LAB_DELTA;
	
	private static final double SIMILAR_COLOR_CIE76 = 2.3;
	
	private static final String RGB_HEX_FORMAT  = "%06X";
	private static final String RGBA_HEX_FORMAT = "%08X";
	
	private static final float COLOR_DARKEN_FACTOR = 0.7f;
	
	/* @see https://en.wikipedia.org/wiki/SRGB#The_reverse_transformation */
	public static double[] rgb2xyz(int r, int g, int b) {
		double rf = toSRGB(r / 255.0);
		double gf = toSRGB(g / 255.0);
		double bf = toSRGB(b / 255.0);
	
		return new double[] { 
			SRGB_2_XYZ_B11 * rf + SRGB_2_XYZ_B12 * gf + SRGB_2_XYZ_B13 * bf,
			SRGB_2_XYZ_B21 * rf + SRGB_2_XYZ_B22 * gf + SRGB_2_XYZ_B23 * bf,
			SRGB_2_XYZ_B31 * rf + SRGB_2_XYZ_B32 * gf + SRGB_2_XYZ_B33 * bf
		};
	}
	
	private static double toSRGB(double u) {
		return (u < 0.04045) ? (25.0 * u / 323.0) : 
			Math.pow((200.0 * u + 11.0) / 211.0, 12.0 / 5.0);
	}

	/* @see https://en.wikipedia.org/wiki/CIELAB_color_space#Forward_transformation */
	public static double[] xyz2lab(double x, double y, double z) {
		double labY = labForward(y / D65_YN);
		
		double l = 116.0 * labY - 16.0;
		double a = 500.0 * (labForward(x / D65_XN) - labY);
		double b = 200.0 * (labY - labForward(z / D65_ZN));
	
		return new double[] { l, a, b };
	}
	
	private static double labForward(double t) {
		return (t > LAB_DELTA_CB) ? Math.cbrt(t) : 
			t / (3.0 * LAB_DELTA_SQ) + 4.0 / 29.0;
	}
	
	public static double[] rgb2lab(int r, int g, int b) {
		double[] xyz = rgb2xyz(r, g, b);
		return xyz2lab(xyz[0], xyz[1], xyz[2]);
	}

	/* @see https://en.wikipedia.org/wiki/Color_difference#CIE76 */
	public static double getColorDifferenceCIE76(double l1, double a1, double b1, double l2, double a2, double b2) {
		double dl = l2 - l1;
		double da = a2 - a1;
		double db = b2 - b1;
		return Math.sqrt(dl * dl + da * da + db * db);
	}
	
	public static boolean isRGBSimilar(int rgb1, int rgb2) {
		return isRGBSimilar(unpackR(rgb1), unpackG(rgb1), unpackB(rgb1), 
		                    unpackR(rgb2), unpackG(rgb2), unpackB(rgb2));
	}

	public static boolean isRGBSimilar(int r1, int g1, int b1, int r2, int g2, int b2) {
		return getColorDifferenceCIE76(rgb2lab(r1, g1, b1), rgb2lab(r2, g2, b2)) < SIMILAR_COLOR_CIE76;
	}
	
	public static double getColorDifferenceCIE76(double[] lab1, double[] lab2) {
		return getColorDifferenceCIE76(lab1[0], lab1[1], lab1[2], lab2[0], lab2[1], lab2[2]);
	}
	
	/* @see https://en.wikipedia.org/wiki/HSL_and_HSV#To_RGB */
	public static int hsb2rgb(double hue, double saturation, double brightness) {
		// Find H' and fraction of H'.
		double h = 6.0 * (hue - Math.floor(hue));
		double f = h - Math.floor(h);
		
		// Find chroma and minimum.
		double c = brightness * saturation;
		double m = brightness - c;

		// Find x + m for even and odd H', respectively.
		double p = m + c * f;
		double q = m + c * (1.0 - f);
		
		switch ((int)h) {
		case 0:
			return denormalizeRGB(brightness, p, m);
		case 1:
			return denormalizeRGB(q, brightness, m);
		case 2:
			return denormalizeRGB(m, brightness, p);
		case 3:
			return denormalizeRGB(m, q, brightness);
		case 4:
			return denormalizeRGB(p, m, brightness);
		case 5:
			return denormalizeRGB(brightness, m, q);
		default:
			return 0xFF000000;
		}
	}

	public static double[] rgb2hsb(int rgb) {
		return rgb2hsb(unpackR(rgb), unpackG(rgb), unpackB(rgb));
	}

	/* @see https://en.wikipedia.org/wiki/HSL_and_HSV#From_RGB */
	public static double[] rgb2hsb(int r, int g, int b) {
		int xmax = Math.max(r, Math.max(g, b));
		int xmin = Math.min(r, Math.min(g, b));
		int c = xmax - xmin;
		
		double hue;
		if (c == 0) {
			hue = 0.0;
		} else {
			if (xmax == r) {
				hue = (double)(g - b) / c;
			} else if (xmax == g) {
				hue = 2.0 + (double)(b - r) / c;
			} else {
				hue = 4.0 + (double)(r - g) / c;
			}
			
			hue /= 6.0;
			if (hue < 0.0)
				hue += 1.0;
		}
		
		double brightness = (double)xmax / 255.0;
		double saturation = (xmax != 0) ? (double)c / xmax : 0.0;
		
		return new double[] { hue, saturation, brightness };
	}
	
	public static int denormalizeRGB(double r, double g, double b) {
		return packRGB((int)(r * 255.0 + 0.5),
		               (int)(g * 255.0 + 0.5),
		               (int)(b * 255.0 + 0.5));
	}

	public static int denormalizeRGBA(double r, double g, double b, double a) {
		return packRGBA((int)(r * 255.0 + 0.5),
		                (int)(g * 255.0 + 0.5),
		                (int)(b * 255.0 + 0.5),
		                (int)(a * 255.0 + 0.5));
	}
	
	public static int withBlue(int rga, double b) {
		return withBlue(rga, (int)(b * 255.0 + 0.5));
	}
	
	public static int withBlue(int rga, int blue) {
		return blue | (rga & 0xFFFFFF00);
	}

	public static int withGreen(int rba, double g) {
		return withGreen(rba, (int)(g * 255.0 + 0.5));
	}
	
	public static int withGreen(int rba, int green) {
		return (green << 8) | (rba & 0xFFFF00FF);
	}

	public static int withRed(int gba, double r) {
		return withRed(gba, (int)(r * 255.0 + 0.5));
	}
	
	public static int withRed(int gba, int red) {
		return (red << 16) | (gba & 0xFF00FFFF);
	}

	public static int withAlpha(int rgb, double a) {
		return withAlpha(rgb, (int)(a * 255.0 + 0.5));
	}
	
	public static int withAlpha(int rgb, int alpha) {
		return (alpha << 24) | (rgb & 0x00FFFFFF);
	}
	
	public static int invertRGB(int rgb) {
		return packRGBA(0xFF - unpackR(rgb),
		                0xFF - unpackG(rgb),
		                0xFF - unpackB(rgb),
		                unpackA(rgb));
	}
	
	public static int packRGB(int r, int g, int b) {
		return 0xFF000000 | (r << 16) | (g << 8) | b;
	}

	public static int packRGBA(int r, int g, int b, int a) {
		return (a << 24) | (r << 16) | (g << 8) | b;
	}
	
	public static int unpackB(int rgba) {
		return rgba & 0xFF;
	}
	
	public static int unpackG(int rgba) {
		return (rgba >>> 8) & 0xFF;
	}

	public static int unpackR(int rgba) {
		return (rgba >>> 16) & 0xFF;
	}

	public static int unpackA(int rgba) {
		return rgba >>> 24;
	}
	
	public static String rgb2str(int rgb) {
		return String.format(RGB_HEX_FORMAT, rgb & 0xFFFFFF);
	}

	public static String rgba2str(int rgba) {
		return String.format(RGBA_HEX_FORMAT, rgba);
	}
	
	public static int str2rgba(String str) {
		int rgba = 0x00000000;
		try {
			rgba = Integer.parseInt(str, 16);
		} catch (NumberFormatException ignore) {
		}
		
		return (str.length() <= 6) ? (rgba | 0xFF000000) : rgba;
	}
	
	public static int darker(int color) {
		int a = unpackA(color);
		int r = unpackR(color);
		int g = unpackG(color);
		int b = unpackB(color);
	
		r = (int)(r * COLOR_DARKEN_FACTOR);
		g = (int)(g * COLOR_DARKEN_FACTOR);
		b = (int)(b * COLOR_DARKEN_FACTOR);

		return packRGBA(r, g, b, a);
	}
	
	public static int brighter(int color) {
		int a = unpackA(color);
		int r = unpackR(color);
		int g = unpackG(color);
		int b = unpackB(color);
	
		int i = (int)(1.0f / (1.0f - COLOR_DARKEN_FACTOR));
		if (r == 0 && g == 0 && b == 0) {
			r = g = b = i;
		} else {
			if (r > 0 && r < i) r = i;
			if (g > 0 && g < i) g = i;
			if (b > 0 && b < i) b = i;
			
			r = Math.min((int)(r / COLOR_DARKEN_FACTOR), 0xFF);
			g = Math.min((int)(g / COLOR_DARKEN_FACTOR), 0xFF);
			b = Math.min((int)(b / COLOR_DARKEN_FACTOR), 0xFF);
		}

		return packRGBA(r, g, b, a);
	}
}
